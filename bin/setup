#!/usr/bin/env bash
set -euo pipefail

echo "ğŸš€ Setting up Fudo Challenge API..."

# Check Ruby version
if ! ruby -v | grep -q "ruby 3"; then
    echo "âŒ Ruby 3.0+ is required"
    exit 1
fi

# Install dependencies
echo "ğŸ“¦ Installing dependencies..."
bundle install

# Run tests to ensure everything works
echo "ğŸ§ª Running tests..."
bundle exec rspec --format progress

# Check code style
echo "ğŸ¨ Checking code style..."
bundle exec rubocop

echo "âœ… Setup complete!"
echo ""
echo "ğŸ¯ Next steps:"
echo "  â€¢ Start the server: bundle exec rake server:start"
echo "  â€¢ Run tests: bundle exec rspec"
echo "  â€¢ Check API docs: http://localhost:9292/openapi.yaml"
echo "  â€¢ Health check: http://localhost:9292/health"
echo ""
echo "ğŸ³ Docker alternative:"
echo "  â€¢ docker-compose up --build"
