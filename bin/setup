#!/usr/bin/env bash
set -euo pipefail

echo "🚀 Setting up Fudo Challenge API..."

# Check Ruby version
if ! ruby -v | grep -q "ruby 3"; then
    echo "❌ Ruby 3.0+ is required"
    exit 1
fi

# Install dependencies
echo "📦 Installing dependencies..."
bundle install

# Run tests to ensure everything works
echo "🧪 Running tests..."
bundle exec rspec --format progress

# Check code style
echo "🎨 Checking code style..."
bundle exec rubocop

echo "✅ Setup complete!"
echo ""
echo "🎯 Next steps:"
echo "  • Start the server: bundle exec rake server:start"
echo "  • Run tests: bundle exec rspec"
echo "  • Check API docs: http://localhost:9292/openapi.yaml"
echo "  • Health check: http://localhost:9292/health"
echo ""
echo "🐳 Docker alternative:"
echo "  • docker-compose up --build"
